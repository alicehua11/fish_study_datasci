"0","fish_bigtable <- ram$timeseries %>% "
"0","  left_join(ram$stock) %>% "
"0","  left_join(ram$area) %>% "
"0","  left_join(ram$tsmetrics, by = c(""tsid"" = ""tsunique"")) %>%"
"0","  group_by(tsyear, scientificname)%>% "
"0","  summarize(total = sum(tsvalue, na.rm = T))  %>% "
"0","  ungroup() %>% "
"0","  group_by(scientificname) %>% "
"0","  mutate(cumulativemax = cummax(total), "
"0","         collapse = total < .1*cumulativemax) %>%"
"0","  select(tsyear, collapse) %>% "
"0","  filter(tsyear > 1949)"
"2","Joining, by = c(""stockid"", ""stocklong"")
"
"2","Joining, by = ""areaid""
"
"2","Adding missing grouping variables: `scientificname`
"
"0","head(fish_bigtable)"
